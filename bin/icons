#!/usr/bin/env php
<?php

require_once dirname(__FILE__) . '/../tools/spyc/Spyc.php';

$data = Spyc::YAMLLoad(dirname(__FILE__) . '/../src/assets/font-awesome/src/icons.yml');
$categories = array();

// transform icons in category based format
foreach($data['icons'] as $icon)
{
	foreach($icon['categories'] as $category)
	{
		$categories[$category][] = $icon['id'];
	}
}

$date   = date('d.m.Y h:i');
$buffer = '';

foreach($categories as $category => $icons)
{
	$buffer .= sprintf("\t '%s' => array (\n", $category);

	foreach($icons as $icon)
	{
		$buffer .= sprintf("\t\t'%s',\n", $icon);
	}

	$buffer .= "\t),\n\n";
}

$output = <<<EOF
<?php

/**
 * Contao Open Source CMS
 *
 * Copyright (C) 2005-2012 Leo Feyer
 *
 * @package   font-awesome
 * @author    David Molineus <http://www.netzmacht.de>
 * @license   GNU/LGPL
 * @copyright Copyright 2012 David Molineus netzmacht creative
 *
 */

// Auto generated icons file, generated by bin/icons
// Date: $date

return array
(
$buffer);
EOF;


$file = fopen(dirname(__FILE__) . '/../src/system/modules/font-awesome/config/icons/icons.php', 'wb+');
fwrite($file, $output);
fclose($file);